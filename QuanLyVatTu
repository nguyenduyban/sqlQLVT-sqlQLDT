--CAU 1

CREATE TABLE LOAIVATU(
Maloai nchar(5),
TenLoai nvarchar(50),
Mota nvarchar(200),
PRIMARY KEY (Maloai)
)
-- CAU 2
ALTER TABLE VATTU ADD CONSTRAINT FK_LOAIVATTU
FOREIGN KEY (MALOAI) REFERENCES LOAIVATTU (MALOAI)


--CAU 3

ALTER TABLE DONHANG ADD CONSTRAINT CHECK1
CHECK(DAY(NGAYDATHANG)<=DAY(GETDATE()))

--CAU 4
INSERT INTO PHIEUNHAP(MAPN,MAVT,SOLUONG)
VALUES('N05','V07','1000')
ALTER TABLE PHIEUNHAP ADD CONSTRAINT FK_MAVATTU
FOREIGN KEY (MAVT) REFERENCES VATTU (MAVT)
INSERT INTO DONGIAMUA
SELECT *DONGIA
FROM PHIEUNHAP PN JOIN VATTU VT ON PN.MAVT=VT.MAVT
WHERE DONGIA = 1/2

-- CAU 5 
SELECT *
FROM VATTU
WHERE DONGIA = (SELECT MAX(DONGIA) FROM VATTU);

--CAU 6
SELECT MAPM,MAVT,TENVT,TENVT,SOLUONG,DONGIAMUA
FROM VATU VT JOIN CHITIETNHAPHANG CT ON VT.MAVT=CT.MAVT
WHERE TENVT = N'ฤรก Mi%'
Oder By Soluong desc

--cau 7
select *
from donhang don1, donghang don2
where don1.maddh<> don2.maddh and don1.ngaydathang = don2.maddh
oder by don1.ngaydathang desc

--Cau 8
select phieunhap,MaxPN,ngaynhap,sum(soluong *dongiamua) as TongTien
from chitietnhaphang join phieunhap on chitiet nhaphang.MaPN = phieunhap.MaPN
Group by phieunhap.MaPN,NgayNhap

--cau 9
select *
from vattu
where MaVT not in(select MaVT from chitietdonhang)

--Cau 10
select *
from vattu
where dongia>(select AVG(dongia) from vattu)

